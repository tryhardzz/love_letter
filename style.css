/* Trang */
body{
  background:#fff;
  font-family:"Segoe UI",system-ui,-apple-system,Roboto,Arial,sans-serif;
  overflow:hidden;
  text-align:center;
}

/* ===== PHONG B√å G·∫¶N ƒê√ÅY ===== */
.envelope{
  position:fixed;
  left:50%;
  bottom:32px;
  transform:translateX(-50%);
  width:420px;
  height:280px;
  cursor:pointer;
  perspective:1200px;
  overflow:visible; /* cho ph√©p th∆∞ tr·ªìi ra nh∆∞ng v·∫´n b·ªã tam gi√°c che */
}

/* N·ªÄN ch·ªØ nh·∫≠t ‚Äî GI·ªÆ THEO S·ªê LI·ªÜU C·ª¶A B·∫†N */
.base{
  position:absolute; inset:0;
  background:linear-gradient(#f8c5cb, #fdbdc8);
  box-shadow:0 18px 40px rgba(246, 152, 199, 0.25);
  z-index:1;
}

/* === 3 TAM GI√ÅC CHE TH∆Ø (to & ch·ªìng l√™n) ‚Äî GI·ªÆ THEO S·ªê LI·ªÜU C·ª¶A B·∫†N === */
.tri{ position:absolute; inset:0; }
.tri.side.left{
  background:#f49ab0;
  clip-path:polygon(0% 0%, 48% 50%, 0% 100%);
  z-index:3;          /* tr√™n th∆∞ */
}
.tri.side.right{
  background:#f49ab0;
  clip-path:polygon(100% 0%, 52% 50%, 100% 100%);
  z-index:3;          /* tr√™n th∆∞ */
}
.tri.bottom{
  background:#f2afbc;
  clip-path:polygon(0% 100%, 50% 40%, 100% 100%);
  z-index:4;          /* tr√™n side */
}

/* N·∫ÆP TR√äN (ƒë√∫ng chi·ªÅu) ‚Äî GI·ªÆ THEO S·ªê LI·ªÜU C·ª¶A B·∫†N */
.tri.flap{
  background:#f7a4b8;
  clip-path:polygon(0% 0%, 100% 0%, 50% 55%);
  transform-origin:50% 0%;
  transition:transform 2s ease;
  z-index:5;          /* d∆∞·ªõi seal */
}
.envelope.open .tri.flap{ transform:rotateX(-150deg); }

/* Seal */
.seal{
  position:absolute; left:50%; top:42%;
  transform:translate(-50%,-50%);
  font-size:48px; line-height:1;
  color:#ff4d6d;
  z-index:6;
  animation:heartbeat 1.4s ease-in-out infinite;
}
@keyframes heartbeat{
  0%,100%{ transform:translate(-50%,-50%) scale(1) }
  50%{ transform:translate(-50%,-50%) scale(1.2) }
}

/* üìú L√° th∆∞ ‚Äì gi·ªØ v·ªã tr√≠/z-index nh∆∞ b·∫°n ƒë√£ c·∫•u h√¨nh */
.letter{
  position:absolute;
  width: 90%; height: 90%;
  left: 5%; bottom: 5%;           /* m·∫•p m√© trong phong b√¨: khi m·ªü n·∫Øp th·∫•y m·ªôt ph·∫ßn ti√™u ƒë·ªÅ */
  background:#fff;
  border-radius:12px;
  box-shadow:0 6px 18px rgba(0,0,0,.12);
  box-sizing:border-box;
  z-index:2;                /* lu√¥n d∆∞·ªõi 3 tam gi√°c */
  overflow:hidden;
  transition:bottom 1.2s ease, transform 1.2s ease;
  perspective: 1200px;      /* üëà c·∫ßn cho flip 3D */
}

/* K√©o th∆∞ l√™n (sau khi m·ªü n·∫Øp) ‚Äì gi·ªØ z-index:2 ƒë·ªÉ KH√îNG ƒë√® l√™n tam gi√°c */
.envelope.pull .tri.flap{
    z-index: 1;
}
.envelope.pull .letter{
  bottom:calc(80% + 32px);
  transform:translateY(-16px);
}

/* üå∏ Hoa xu·∫•t hi·ªán sau khi m·ªü phong b√¨ (·ªü SAU l√° th∆∞) */
.flower{
  position: absolute;
  bottom:70%;                 /* ngang m√©p d∆∞·ªõi c·ªßa l√° th∆∞ ƒëang n·∫±m trong b√¨ */
  width: 200px;                /* ch·ªânh theo ·∫£nh th·ª±c t·∫ø */
  opacity: 0;
  transform: translateY(16px) scale(0.92);
  transition: opacity .9s ease, transform .9s ease;
  z-index: 0;                  /* = th∆∞, NH∆ØNG th∆∞ n·∫±m sau trong DOM n√™n v·∫´n ·ªü TR√äN */
  pointer-events: none;
}

/* cƒÉn theo v·ªã tr√≠ l√° th∆∞: th∆∞ c√≥ left:7%; width:86% => m√©p hai b√™n c√°ch bi√™n b√¨ 7%  */
.flower-left{
  left: -110px;                 /* h∆°i th√≤ ra ngo√†i b√¨, t√πy ch·ªânh */
  transform-origin: right bottom;
}
.flower-right{
  right: -130px;
  transform-origin: left bottom;
}

/* Khi m·ªü phong b√¨ -> hoa tr·ªìi l√™n (xu·∫•t hi·ªán s·ªõm, tr∆∞·ªõc l√∫c k√©o th∆∞) */
.envelope.pull .flower{
  opacity: 1;
  transform: translateY(-6px) scale(1);
}

/* N·∫øu mu·ªën hoa xu·∫•t hi·ªán CH·ªà khi th∆∞ b·∫Øt ƒë·∫ßu k√©o l√™n, d√πng .pull thay .open ·ªü tr√™n */

/* ‚Äî‚Äî Page-flip ‚Äî‚Äî */
.sheet{
  position:absolute; inset:0;
  transform-style: preserve-3d;
  transition: transform .9s ease;
  border-radius: 12px;
}

/* M·∫∑t trang */
.face{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  backface-visibility: hidden;
  background:#fff;
  border-radius: 12px;
}

/* Trang 1 (m·∫∑t tr∆∞·ªõc) ‚Äî ti√™u ƒë·ªÅ l·ªõn */
.face.front .title{
  width:100%;
  font-family:"Playfair Display", serif;
  font-weight:800;
  line-height:1.05;
  text-align:center;
  color:#c15c6f;
  font-size:clamp(28px, 6vw, 46px);
  letter-spacing:.5px;
}
.face.front .title > div{ margin:2px 0; }

/* Trang 2 (m·∫∑t sau) */
.face.back{
  transform: rotateY(180deg);
}
/* .face.back .content{
  white-space: pre-line;
  font-size:16px;
  color:#333;
  line-height:1.6;
  text-align:left;
  max-height:100%;
  overflow:hidden;
  padding:26px 22px;
} */

/* Khi l·∫≠t sang trang 2 */
.letter.flip .sheet{
  transform: rotateY(180deg);
}

/* (tu·ª≥ ch·ªçn) ƒë·ªï b√≥ng nh·∫π khi l·∫≠t */
.letter:not(.flip) .sheet{ box-shadow: 0 0 0 rgba(0,0,0,0); }
.letter.flip .sheet{ box-shadow: 0 10px 24px rgba(0,0,0,.12); }


/* N√∫t nh·∫°c (tu·ª≥ ch·ªçn) */
#musicBtn{
  position:fixed; right:20px; bottom:20px;
  background:pink; border:none; padding:10px 16px;
  border-radius:10px; box-shadow:0 2px 8px rgba(255,105,180,.35);
  cursor:pointer; font-weight:700;
}
#musicBtn:hover{ transform:translateY(-1px); }

/* ‚ù§Ô∏è Tr√°i tim bay */
.floating-heart {
  position: absolute;
  color: #ff6fa0;
  font-size: 24px;
  animation: fly 4s linear forwards;
}
@keyframes fly {
  0% { transform: translateY(0) scale(1); opacity: 1; }
  100% { transform: translateY(-600px) scale(1.5); opacity: 0; }
}

/* Typing: ch·ªâ gi·ªØ ƒë·ªãnh d·∫°ng & caret */
/* Container trang 2 */
.face.back .content{
  white-space: pre-wrap;     /* ƒë·ªÉ DOM quy·∫øt ƒë·ªãnh xu·ªëng d√≤ng (c√≥ <br>) */
  text-align: justify;        /* ƒë·ªïi sang justify n·∫øu b·∫°n th√≠ch */
  line-height: 1.7;
  color: #333;
  max-height: 100%;
  overflow: hidden;        /* b·∫≠t auto sau khi g√µ xong trong JS */
  padding: 26px 22px;
}

/* M·ªói d√≤ng l√† block ri√™ng */
.content .line{
  display: block;
  margin: 0 0 .6rem 0;
}

/* Caret r·ªùi, k√≠ch th∆∞·ªõc c·ªë ƒë·ªãnh */
.content .line .typeText{ display: inline; white-space: pre-wrap; }
.content .line .caret{
  display: inline-block;
  width: 1ch; height: 1em;
  border-left: 2px solid currentColor;
  vertical-align: -0.1em;
  animation: caretBlink .9s steps(1) infinite;
}
@keyframes caretBlink{ 50% { border-color: transparent; } }


