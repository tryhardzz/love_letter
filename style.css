/* ====== C∆† B·∫¢N ====== */
body{
  background:#fff;
  font-family:"Segoe UI",system-ui,-apple-system,Roboto,Arial,sans-serif;
  overflow:hidden;
  text-align:center;
  margin:0;
}

/* ===== PHONG B√å G·∫¶N ƒê√ÅY ===== */
.envelope{
  position:fixed;
  left:50%;
  bottom:32px;
  transform:translateX(-50%);
  width:420px;
  height:280px;
  cursor:pointer;
  perspective:1200px;
  overflow:visible; /* cho ph√©p th∆∞ tr·ªìi ra nh∆∞ng v·∫´n b·ªã tam gi√°c che */
}

/* N·ªÄN ch·ªØ nh·∫≠t */
.base{
  position:absolute; inset:0;
  background:linear-gradient(#f8c5cb, #fdbdc8);
  box-shadow:0 18px 40px rgba(246, 152, 199, 0.25);
  z-index:1;
}

/* === 3 TAM GI√ÅC CHE TH∆Ø === */
.tri{ position:absolute; inset:0; }
.tri.side.left{
  background:#f49ab0;
  clip-path:polygon(0% 0%, 48% 50%, 0% 100%);
  z-index:3;
}
.tri.side.right{
  background:#f49ab0;
  clip-path:polygon(100% 0%, 52% 50%, 100% 100%);
  z-index:3;
}
.tri.bottom{
  background:#f2afbc;
  clip-path:polygon(0% 100%, 50% 40%, 100% 100%);
  z-index:4;
}

/* N·∫ÆP TR√äN */
.tri.flap{
  background:#f7a4b8;
  clip-path:polygon(0% 0%, 100% 0%, 50% 55%);
  transform-origin:50% 0%;
  transition:transform 2s ease;
  z-index:5;
}
.envelope.open .tri.flap{ transform:rotateX(-150deg); }

/* SEAL */
.seal{
  position:absolute; left:50%; top:42%;
  transform:translate(-50%,-50%);
  font-size:48px; line-height:1;
  color:#ff4d6d;
  z-index:6;
  animation:heartbeat 1.4s ease-in-out infinite;
}
@keyframes heartbeat{
  0%,100%{ transform:translate(-50%,-50%) scale(1) }
  50%{ transform:translate(-50%,-50%) scale(1.2) }
}

/* üìú L√Å TH∆Ø */
.letter{
  position:absolute;
  width:90%; height:90%;
  left:5%; bottom:5%;
  background:#fff;
  border-radius:12px;
  box-shadow:0 6px 18px rgba(0,0,0,.12);
  box-sizing:border-box;
  z-index:2;
  overflow:hidden;
  transition:bottom 1.2s ease, transform 1.2s ease;
  perspective:1200px;
}
.envelope.pull .tri.flap{ z-index:1; }
.envelope.pull .letter{
  bottom:calc(80% + 32px);
  transform:translateY(-16px);
}

/* üå∏ HOA TRANG TR√ç */
.flower{
  position:absolute;
  bottom:70%;
  width:200px;
  opacity:0;
  transform:translateY(16px) scale(0.92);
  transition:opacity .9s ease, transform .9s ease;
  z-index:0;
  pointer-events:none;
}
.flower-left{
  left:-110px;
  transform-origin:right bottom;
}
.flower-right{
  right:-130px;
  transform-origin:left bottom;
}
.envelope.pull .flower{
  opacity:1;
  transform:translateY(-6px) scale(1);
}

/* ‚Äî‚Äî PAGE FLIP ‚Äî‚Äî */
.sheet{
  position:absolute; inset:0;
  transform-style:preserve-3d;
  transition:transform .9s ease;
  border-radius:12px;
}
.face{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  backface-visibility:hidden;
  background:#fff;
  border-radius:12px;
}
.face.front .title{
  width:100%;
  font-family:"Playfair Display",serif;
  font-weight:800;
  line-height:1.05;
  text-align:center;
  color:#c15c6f;
  font-size:clamp(28px,6vw,46px);
  letter-spacing:.5px;
}
.face.front .title>div{ margin:2px 0; }
.face.back{ transform:rotateY(180deg); }
.letter.flip .sheet{ transform:rotateY(180deg); }
.letter:not(.flip) .sheet{ box-shadow:0 0 0 rgba(0,0,0,0); }
.letter.flip .sheet{ box-shadow:0 10px 24px rgba(0,0,0,.12); }

/* N√∫t nh·∫°c */
#musicBtn{
  position:fixed; right:20px; bottom:20px;
  background:pink; border:none; padding:10px 16px;
  border-radius:10px; box-shadow:0 2px 8px rgba(255,105,180,.35);
  cursor:pointer; font-weight:700;
}
#musicBtn:hover{ transform:translateY(-1px); }

/* ‚ù§Ô∏è TR√ÅI TIM BAY */
.floating-heart{
  position:absolute;
  color:#ff6fa0;
  font-size:24px;
  animation:fly 4s linear forwards;
}
@keyframes fly{
  0%{ transform:translateY(0) scale(1); opacity:1; }
  100%{ transform:translateY(-600px) scale(1.5); opacity:0; }
}

/* üñãÔ∏è N·ªòI DUNG TRANG 2 */
.face.back .content{
  white-space:pre-wrap;
  text-align:justify;
  line-height:1.7;
  color:#333;
  max-height:100%;
  overflow:hidden;
  padding:26px 22px;
}
.content .line{ display:block; margin:0 0 .6rem 0; }
.content .line .typeText{ display:inline; white-space:pre-wrap; }
.content .line .caret{
  display:inline-block;
  width:1ch; height:1em;
  border-left:2px solid currentColor;
  vertical-align:-0.1em;
  animation:caretBlink .9s steps(1) infinite;
}
@keyframes caretBlink{ 50%{ border-color:transparent; } }

/* ===================================================== */
/* üß≠ RESPONSIVE CHO MOBILE */
/* ===================================================== */

@media (max-width: 768px){
  body{
    overflow:auto; /* cho ph√©p cu·ªôn n·∫øu c·∫ßn */
  }

  .envelope{
    width:90vw;
    height:auto;
    aspect-ratio:3/2; /* gi·ªØ t·ªâ l·ªá 420:280 */
    bottom:16px;
  }

  .letter{
    width:92%;
    left:4%;
    bottom:4%;
  }

  .seal{ font-size:40px; top:44%; }

  .flower{
    width:28vw;
    bottom:68%;
  }
  .flower-left{ left:-60px; }
  .flower-right{ right:-60px; }

  .face.front .title{
    font-size:clamp(22px,7vw,36px);
  }

  .face.back .content{
    font-size:14px;
    line-height:1.6;
    padding:18px 16px;
  }

  #musicBtn{
    right:10px;
    bottom:10px;
    padding:8px 12px;
    font-size:14px;
  }
}

@media (max-width:480px){
  .envelope{
    width:94vw;
    aspect-ratio:3/2;
    bottom:10px;
  }
  .flower{
    width:34vw;
    bottom:70%;
  }
  .face.back .content{ font-size:13px; }
}
